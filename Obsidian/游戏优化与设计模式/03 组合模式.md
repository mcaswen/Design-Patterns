
### 零、概念

- 一种结构型设计模式

- 将对象组合成树状结构来表示“整体-部分的关系”，并能够像使用独立对象一样使用它们

### 一、实现要点

- **组件结构(Component)**：定义叶子和容器的共同接口，声明操作和管理子组件的方法

- **叶子节点(Leaf)**：表示树中的叶子节点，没有子节点，实现Execute()

- **复合节点(Composite)**：存储子组件，实现与子组件相关的操作，并把所有工作委派给子元素

### 二、UML图展示

![500](组合模式UML.png)

### 三、具体应用

- **例：对于玩家控制，实现不同的操作映射，键盘WASD/键盘上下左右/手柄...**

- **UML图示例**：
![[Pasted image 20251127091847.png]]

- **实现要点：**

	- `MoveControl()` 不再直接获取键盘上的按键值，而是拿取`MoveControl`抽象类中的方向布尔变量，并通过该变量设置速度
	
	- `SetMoveControl()` 用于改变`Player`类中`_moveControl`成员变量的值
	
	- `_moveControl`的类型`MoveControl*`是基类指针，利用多态特性关联`MoveControlArrow`（方向键控制）和`MoveControlWASD`（`wasd`键控制）
	
	- 继承类可以无限拓展，都利用`Update()`实时更新`MoveControl`中四个方向的布尔值

### 四、总结

#### 核心价值：

- **统一接口**：所有控制组件（单个或组合）都提供一致的`Update`接口，客户端无需区分
    
- **灵活组合**：可以动态地添加、移除或替换控制方式，支持多种输入设备的混合使用
    
- **递归处理**：复合节点自动将操作委托给所有子组件，简化了复杂控制逻辑的管理
    
#### 适用场景：

- 需要表示"部分-整体"层次结构的系统
    
- 希望客户端以统一方式处理单个对象和对象组合
    
- 需要动态添加或移除功能的场景